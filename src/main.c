#include "disasm.h"

int main(void)
{
    const unsigned char instructions[] = {
        0x55, // push rbp
        0x48, 0x89, 0xe5, // mov rbp, rsp
        0x48, 0x83, 0xec, 0x10, // sub rsp, 0x10
        0xe8, 0xe8, 0xff, 0xff, 0xff, // call 1139
        0x89, 0x45, 0xfc, // mov [rbp-0x4], eax
        0x48, 0x89, 0x30, // mov [rax], rsi 
        0x8b, 0x45, 0xfc, // mov eax, [rbp-0x4]
        0x48, 0x8d, 0x15, 0xa6, 0x0e, 0x00, 0x00, // lea rdx, [rip+0xea6]
        0x89, 0xc6, // mov esi, eax
        0x48, 0x89, 0xd7, // mov rdi, rdx
        0xb8, 0x00, 0x00, 0x00, 0x00, // mov eax, 0x0
        0xe8, 0xc3, 0xfe, 0xff, 0xff, // call 1030

        0xb8, 0x00, 0x00, 0x00, 0x00, // mov eax, 0x0

        0x48, 0x89, 0x3c, 0x84, // mov [rsp+rax*4], rdi
        0x67, 0x89, 0x3C, 0x90, // mov [eax+edx*4], edi
        0x67, 0x48, 0x89, 0x3C, 0x90, // mov [eax+edx*4], rdi
        0x67, 0x66, 0x89, 0x3C, 0x90, // mov [eax+edx*4], di
        0x89, 0x3c, 0x90, // mov [rax+rdx*4], edi
        0x66, 0x89, 0x3c, 0x90, // mov [rax+rdx*4], di

        0x48, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov [rip + 0x10], rsi
        0x67, 0x48, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov [eip + 0x10], rsi
        0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov [rip + 0x10], esi
        0x66, 0x89, 0x35, 0x10, 0x00, 0x00, 0x00, // mov [rip + 0x10], si

        0x89, 0x06, // mov [rsi], eax
        0x48, 0x89, 0x06, // mov [rsi], rax
        0x66, 0x89, 0x06, // mov [rsi], ax
        0x67, 0x89, 0x06, // mov [esi], eax
        0x67, 0x48, 0x89, 0x06, // mov [esi], rax
        0x67, 0x66, 0x89, 0x06, // mov [esi], ax

        0xc9, // leave
        0xc3 // ret
    };

    disasm(instructions, sizeof(instructions));
    return 0;
}
